# ═══════════════════════════════════════════════════════════════════════
# ONEE Horizon Forecast Configuration - CD (Contrats/Distributeurs)
# ═══════════════════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────────────────
# PILLAR 1: PROJECT
# ───────────────────────────────────────────────────────────────────────
project:
  project_root: .  # Will be resolved to absolute path
  exp_name: gp_1
  output_base_dir: outputs_horizon_cd

# ───────────────────────────────────────────────────────────────────────
# PILLAR 2: DATA
# ───────────────────────────────────────────────────────────────────────
data:
  target_variable: consommation_kwh
  unit: Kwh
  impute_2020: false
  
  # No regions for CD (operates on contracts/activities)
  regions: null
  
  # Run levels for CD:
  # 1: Individual Contracts
  # 2: Partenaire (clients)
  # 3: Activities
  run_levels: [3]
  
  # Database paths (relative to project_root)
  db_path: data/all_data.db

# ───────────────────────────────────────────────────────────────────────
# PILLAR 3: TEMPORAL
# ───────────────────────────────────────────────────────────────────────
temporal:
  horizon: 5
  forecast_runs:
    - [2015, 2018]

# ───────────────────────────────────────────────────────────────────────
# PILLAR 4: FEATURES
# ───────────────────────────────────────────────────────────────────────
features:
  transforms:
    - [level, lchg]
  
  lags:
    - [1, 2]
  
  feature_block:
    - [total_active_contrats, just_started, two_years_old, three_years_old, more_than_3_years_old, pib_mdh]
  
  use_pf: [true]
  use_clients: [false]
  training_window: [null]

# ───────────────────────────────────────────────────────────────────────
# PILLAR 5: MODELS
# ───────────────────────────────────────────────────────────────────────
models:
  r2_threshold: 0.6
  
  models:
    # ─── Intensity Forecast Wrapper (CD-specific) ───
    - model_type: IntensityForecastWrapper
      
      # IntensityForecastWrapper-specific
      normalization_col: [total_active_contrats]
      
      # GP parameters for internal model
      # Kernel options: null (default), 'rbf_white', 'matern_white', 'rbf_dot_white', 'matern_smooth', 'rbf_long'
      kernel_key: ["rbf_white"]
      n_restarts_optimizer: [10]
      normalize_y: [true, false]
      use_log_transform: [false]
      alpha: [1e-10]
      
      # Outlier detection
      remove_outliers: [False]
      outlier_threshold: [2.5]
      
      # Prior Configuration for internal GP model - list of prior configs to try
      prior_config:
        # - type: LinearGrowthPrior
        #   min_annual_growth: 0.0
        #   anchor_window: 3
        - type: PowerGrowthPrior
          power: 1
          anchor_window: 3
          min_annual_growth: null
        # - type: FlatPrior
        #   method: mean
        #   anchor_window: 3